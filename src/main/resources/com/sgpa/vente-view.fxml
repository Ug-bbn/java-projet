<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<ScrollPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.sgpa.controller.VenteController"
            fitToWidth="true" fitToHeight="true"
            styleClass="content-area">
<VBox spacing="12">
    <padding><Insets top="18" right="18" bottom="18" left="18"/></padding>

    <Label text="Ventes" styleClass="section-title"/>
    <Separator/>

    <!-- Formulaire de vente -->
    <VBox spacing="10" styleClass="details-panel">
        <Label text="Nouvelle Vente" styleClass="label-bold">
            <font><Font name="System Bold" size="15"/></font>
        </Label>

        <HBox spacing="10" alignment="CENTER_LEFT">
            <ComboBox fx:id="cmbMedicament" prefWidth="280" HBox.hgrow="ALWAYS"/>
            <Label text="Qté:"/>
            <TextField fx:id="txtQuantite" promptText="1" prefWidth="70"/>
            <Button text="Ajouter au panier" onAction="#handleAjouterArticle" styleClass="button-success"/>
        </HBox>

        <HBox spacing="15" alignment="CENTER_LEFT">
            <Label fx:id="lblStockDisponible" text="" style="-fx-text-fill: #27ae60; -fx-font-weight: bold;"/>
            <Region HBox.hgrow="ALWAYS"/>
            <CheckBox fx:id="chkOrdonnance" text="Vente sur ordonnance"/>
        </HBox>

        <Separator/>

        <!-- Panier -->
        <TableView fx:id="tablePanier" prefHeight="140" styleClass="table-view">
            <placeholder><Label text="Panier vide. Ajoutez des médicaments ci-dessus."/></placeholder>
            <columns>
                <TableColumn fx:id="colPanierMedicament" text="Médicament" minWidth="200"/>
                <TableColumn fx:id="colPanierQuantite" text="Quantité" minWidth="80" prefWidth="90"/>
                <TableColumn fx:id="colPanierPrixUnit" text="Prix unitaire (€)" minWidth="100" prefWidth="120"/>
                <TableColumn fx:id="colPanierTotal" text="Total (€)" minWidth="100" prefWidth="120"/>
            </columns>
            <columnResizePolicy><TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/></columnResizePolicy>
        </TableView>

        <HBox spacing="10" alignment="CENTER_RIGHT">
            <Button text="Retirer sélection" onAction="#handleRetirerArticle" styleClass="button-danger"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Label fx:id="lblTotalVente" text="" styleClass="label-bold"/>
            <Button text="Nouveau" onAction="#handleNouveau" styleClass="button"/>
            <Button text="Enregistrer Vente" onAction="#handleEnregistrerVente" styleClass="button-success"/>
        </HBox>
    </VBox>

    <!-- Historique des ventes -->
    <VBox spacing="10" VBox.vgrow="ALWAYS">
        <Label text="Historique des Ventes" styleClass="label-bold">
            <font><Font name="System Bold" size="14"/></font>
        </Label>

        <TableView fx:id="tableHistorique" VBox.vgrow="ALWAYS">
            <columns>
                <TableColumn fx:id="colId" text="ID" prefWidth="50"/>
                <TableColumn fx:id="colMedicaments" text="Médicaments" prefWidth="250"/>
                <TableColumn fx:id="colDate" text="Date/Heure" prefWidth="200"/>
                <TableColumn fx:id="colTotal" text="Total (€)" prefWidth="100"/>
                <TableColumn fx:id="colOrdonnance" text="Ordonnance" prefWidth="100"/>
            </columns>
        </TableView>
    </VBox>
</VBox>
</ScrollPane>
